{"remainingRequest":"E:\\1804\\20200403\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\1804\\20200403\\src\\views\\Products.vue?vue&type=style&index=0&id=7177119e&scoped=true&lang=css&","dependencies":[{"path":"E:\\1804\\20200403\\src\\views\\Products.vue","mtime":1586526611974},{"path":"E:\\1804\\20200403\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\1804\\20200403\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\1804\\20200403\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\1804\\20200403\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\1804\\20200403\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmVsLW1haW4gewogIHBhZGRpbmc6IDA7CiAgbWFyZ2luOiAwOwp9CgouYnRuZWwgewogIGJhY2tncm91bmQtY29sb3I6IHJnYigyNDUsIDI0NSwgMjQ1KTsKICBwYWRkaW5nOiAxMHB4OwogIHRleHQtYWxpZ246IGxlZnQ7Cn0KCi5wYWdlIHsKICBtYXJnaW4tdG9wOiAxNXB4OwogIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgdGV4dC1hbGlnbjogbGVmdDsKfQo="},{"version":3,"sources":["Products.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8QA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Products.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <el-main>\r\n    <div class=\"btnel\">\r\n      <el-row>\r\n        <el-input style=\"width: 200px;margin-right: 20px\"\r\n                  placeholder=\"请输入关键字搜索\"\r\n                  v-model=\"input\"\r\n                  clearable>\r\n        </el-input>\r\n        <el-button icon=\"el-icon-search\" circle @click=\"search(input)\"></el-button>\r\n        <el-button type=\"primary\" @click=\"addDialogVisible = true\">添加产品</el-button>\r\n        <el-button type=\"danger\" round @click=\"delBatch()\">批量删除</el-button>\r\n      </el-row>\r\n    </div>\r\n\r\n    <el-table :data=\"tableData\" border height=\"320\"\r\n              @selection-change=\"handleSelectionChange\"\r\n              ref=\"multipleTable\"\r\n              :summary-method=\"getSummaries\"\r\n              show-summary\r\n              tooltip-effect=\"dark\">\r\n      <el-table-column\r\n        type=\"selection\"\r\n        width=\"55\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"id\" label=\"id\" width=\"100\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"productName\" label=\"名称\" width=\"100\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"product_price\" sortable label=\"价格\" width=\"100\">\r\n      </el-table-column>\r\n\r\n      <el-table-column prop=\"total\" sortable label=\"总数\" width=\"100\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"imagePath\" label=\"描述图片\">\r\n        <template scope=\"scope\">\r\n          <img  v-for=\"item in scope.row.imagePath\" :src=\"item.imagePath\" :key=\"item.imagePath\"\r\n               width=\"40\" height=\"40\"\r\n               class=\"head_pic\"/>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <el-table-column label=\"操作\" width=\"200\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            size=\"mini\"\r\n            @click=\"handleEdit(scope.$index, scope.row)\">编辑\r\n          </el-button>\r\n          <el-button\r\n            size=\"mini\"\r\n            type=\"danger\"\r\n            @click=\"handleDelete(scope.$index, scope.row)\">删除\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <div class=\"page\">\r\n      <div class=\"block\">\r\n        <el-pagination\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page=\"currentPage\"\r\n          :page-sizes=\"[2, 4, 8, 10]\"\r\n          :page-size=\"pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=totalCount>\r\n        </el-pagination>\r\n      </div>\r\n      <el-dialog title=\"添加产品\" :visible.sync=\"addDialogVisible\" width=\"50%\">\r\n        <add-product></add-product>\r\n      </el-dialog>\r\n      <el-dialog title=\"修改产品\" :visible.sync=\"editDialogVisible\" width=\"50%\">\r\n        <edit-product ref=\"edit\"></edit-product>\r\n      </el-dialog>\r\n    </div>\r\n\r\n  </el-main>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nimport AddProduct from './AddProduct'\r\nimport EditProduct from './EditProduct'\r\n\r\nexport default {\r\n\r\n  name: 'products',\r\n  components: {\r\n    EditProduct,\r\n    AddProduct\r\n\r\n  },\r\n  data () {\r\n    return {\r\n      input: '',\r\n      tableData: [],\r\n      addDialogVisible: false,\r\n      editDialogVisible: false,\r\n      pageSize: 8,\r\n      ids: '', // '59,60,61\"\r\n      totalCount: 0,\r\n      currentPage: 1\r\n    }\r\n  },\r\n  created () {\r\n    this.getList(this.input, this.currentPage, this.pageSize)\r\n    this.getProductListCount()\r\n  },\r\n\r\n  methods: {\r\n    getProductListCount () {\r\n      this.$http.post('getListCount', { productName: this.input }, { emulateJSON: true })\r\n        .then(d => {\r\n          if (d.body.code === 0) {\r\n            this.totalCount = d.body.result\r\n          }\r\n        })\r\n    },\r\n\r\n    handleSizeChange (val) {\r\n      console.log(`每页 ${val} 条`)\r\n      this.pageSize = val\r\n      console.log('this.pageSize>>>>' + this.pageSize)\r\n      this.getList(this.input, this.currentPage, this.pageSize)\r\n    },\r\n    handleCurrentChange (val) {\r\n      console.log(`当前页: ${val}`)\r\n      this.currentPage = val\r\n      console.log('this.currentPage>>>>' + this.currentPage)\r\n      this.getList(this.input, this.currentPage, this.pageSize)\r\n    },\r\n\r\n    handleSelectionChange (val) {\r\n      for (let i = 0; i < val.length; i++) {\r\n        if (i === 0) {\r\n          this.ids = val[i].id\r\n        }\r\n        if (i >= 1) {\r\n          this.ids = this.ids + ',' + val[i].id\r\n        }\r\n      }\r\n      // 要拼接的结果是  59，60，61\r\n      console.log(this.ids)\r\n    },\r\n\r\n    delBatch () {\r\n      console.log('this.ids>>>' + this.ids)\r\n      this.$http.post('deleteProductsByids', { ids: this.ids }, { emulateJSON: true })\r\n        .then(d => {\r\n          if (d.body > 0) {\r\n            this.$message({\r\n              message: '删除成功',\r\n              type: 'success'\r\n            })\r\n            this.getList(this.input, this.currentPage, this.pageSize)\r\n            this.getProductListCount()\r\n          }\r\n        })\r\n    },\r\n    // String productName, int pageCount, int pageSize\r\n    getList (productName, currentPage, pageSize) {\r\n      this.tableData = []\r\n      this.$http.post('getProductPageByName', {\r\n        productName: productName,\r\n        currentPage: currentPage,\r\n        pageSize: pageSize\r\n      }, { emulateJSON: true }).then(d => {\r\n        if (d.body.code === 0) {\r\n          for (var i = 0; i < d.body.data.length; i++) {\r\n            var imagePaths = []\r\n            var pathArr = d.body.data[i].imagePath.split(',')\r\n            console.log('pathArr>>>' + pathArr)\r\n            for (var j = 0; j < pathArr.length; j++) {\r\n              imagePaths.push({ imagePath: 'http://localhost:8000/upload/' + pathArr[j] })\r\n              console.log('imagePaths>>>' + imagePaths)\r\n            }\r\n            this.tableData.push({\r\n              id: d.body.data[i].id,\r\n              productName: d.body.data[i].productName,\r\n              product_price: d.body.data[i].product_price,\r\n              total: d.body.data[i].total,\r\n              imagePath: imagePaths\r\n            })\r\n          }\r\n        } else if (d.body.code === -1) {\r\n          this.tableData = []\r\n        }\r\n        console.log(this.tableData)\r\n      })\r\n    },\r\n\r\n    search (input) {\r\n      this.getList(input, this.currentPage, this.pageSize)\r\n      this.getProductListCount()\r\n    },\r\n\r\n    handleEdit (index, row) {\r\n      this.editDialogVisible = true\r\n      // 因为第一次打开子组件需要点时间 才能初始化好子组件的data和methods 所以需要做一个时间延迟\r\n      setTimeout(() => {\r\n        this.$refs.edit.init(row.id)\r\n      }, 80)\r\n    },\r\n    handleDelete (index, row) {\r\n      this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n        center: true\r\n      }).then(() => {\r\n        this.$http.get('deleteProductByid/' + row.id).then(d => {\r\n          if (d.body === 1) {\r\n            this.$message({\r\n              message: '删除成功',\r\n              type: 'success'\r\n            })\r\n            this.getList(this.input, this.currentPage, this.pageSize)\r\n            this.getProductListCount()\r\n          } else {\r\n            this.$message({\r\n              message: '删除失败',\r\n              type: 'warning'\r\n            })\r\n          }\r\n        })\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        })\r\n      })\r\n\r\n      console.log(index, row)\r\n    },\r\n    getSummaries (param) {\r\n      const { columns, data } = param\r\n      const sums = []\r\n      columns.forEach((column, index) => {\r\n        if (index === 0) {\r\n          sums[index] = '总价'\r\n          return\r\n        } else if (index === 1 || index === 2) {\r\n          return\r\n        }\r\n        const values = data.map(item => Number(item[column.property]))\r\n        if (!values.every(value => isNaN(value))) {\r\n          sums[index] = values.reduce((prev, curr) => {\r\n            const value = Number(curr)\r\n            if (!isNaN(value)) {\r\n              return prev + curr\r\n            } else {\r\n              return prev\r\n            }\r\n          }, 0)\r\n          sums[index] += ' 元'\r\n        } else {\r\n          sums[index] = 'N/A'\r\n        }\r\n      })\r\n\r\n      return sums\r\n    }\r\n\r\n  }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  .el-main {\r\n    padding: 0;\r\n    margin: 0;\r\n  }\r\n\r\n  .btnel {\r\n    background-color: rgb(245, 245, 245);\r\n    padding: 10px;\r\n    text-align: left;\r\n  }\r\n\r\n  .page {\r\n    margin-top: 15px;\r\n    margin-bottom: 10px;\r\n    text-align: left;\r\n  }\r\n</style>\r\n"]}]}